# 📋 תוכנית עבודה - ממשק ויזואלי למערכת התראות

## 🎯 מטרות הפרויקט

1. **ממשק ויזואלי נקי ומודרני** לניהול המערכת
2. **שליטה מלאה** על הסקריפטים (הפעלה/עצירה/מצב)
3. **ניהול התראות** - בחירה איזה התראות להפיץ
4. **מעקב בזמן אמת** - התראות, תחנות, סטטיסטיקות
5. **היסטוריה ולוגים** - רישום כל הפעולות

---

## 🏗️ ארכיטקטורה מומלצת

### Stack טכנולוגיות:
- **Backend**: Node.js + Express.js
- **Frontend**: HTML5 + CSS3 + JavaScript (Vanilla או React/Vue)
- **Real-time**: WebSocket (Socket.io)
- **Data Storage**: JSON files (או SQLite למסד נתונים קל)
- **Styling**: Modern CSS Framework (Bootstrap/Tailwind או CSS מותאם)

### מודלים:
1. **Web Server** (Express) - API + Static files
2. **Scanner Service** - שירות מבוקר של הסורק
3. **WebSocket Server** - עדכונים בזמן אמת
4. **Settings Manager** - ניהול הגדרות והעדפות

---

## 📐 מבנה הקבצים המוצע

```
NotiSystem-main/
├── backend/
│   ├── server.js              # שרת Express + WebSocket
│   ├── api/
│   │   ├── scanner.js         # API לשליטה בסורק
│   │   ├── alerts.js          # API לניהול התראות
│   │   ├── stations.js        # API לניהול תחנות
│   │   └── settings.js        # API להגדרות
│   ├── services/
│   │   ├── scannerService.js  # שירות מבוקר של הסורק
│   │   └── settingsManager.js # ניהול הגדרות
│   └── data/
│       ├── settings.json      # הגדרות (איזה התראות להפיץ)
│       └── logs.json          # לוגים (אופציונלי)
│
├── frontend/
│   ├── index.html             # דף ראשי
│   ├── css/
│   │   ├── main.css           # עיצוב ראשי
│   │   └── components.css     # קומפוננטות
│   ├── js/
│   │   ├── app.js             # אפליקציה ראשית
│   │   ├── scanner.js         # לוגיקה סורק
│   │   ├── alerts.js          # לוגיקה התראות
│   │   └── ui.js              # פונקציות UI
│   └── assets/                # תמונות, אייקונים
│
├── scanner.js                 # (קיים) - הסורק המקורי
├── stationManager.js          # (קיים)
├── telnetClient.js            # (קיים)
├── package.json               # עדכון תלויות
└── README.md
```

---

## 🎨 עיצוב UI - דף ראשי

### Layout מוצע:

```
┌─────────────────────────────────────────────────────────────┐
│  🚨 מערכת התראות פיקוד העורף                    [⚙️ הגדרות] │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────────────┐  ┌──────────────────┐               │
│  │  מצב סורק       │  │  סטטיסטיקות     │               │
│  │  ● פועל         │  │  סריקות: 1,234  │               │
│  │  [⏸ עצור]      │  │  התראות: 45     │               │
│  └──────────────────┘  │  TELNET: 89%    │               │
│                        └──────────────────┘               │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  ניהול התראות להפצה                                 │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │  ☑️ ירי רקטות וטילים (00112)                        │   │
│  │  ☑️ רעידת אדמה (00110)                              │   │
│  │  ☑️ חדירת כלי טיס עוין (00111)                      │   │
│  │  ☑️ התרעה מקדימה (00113)                            │   │
│  │  ☐ אירוע רדיולוגי (לא מוגדר)                        │   │
│  │  ☐ צונמי (לא מוגדר)                                 │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  התראות אחרונות (זמן אמת)                            │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │  🚨 טילים | תל אביב | 14:32:15 | ✅ נשלח (12 תחנות)│   │
│  │  ⚠️ רעידת אדמה | טבריה | 13:45:22 | ✅ נשלח (1)   │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  תחנות מושפעות (התראה נוכחית)                        │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │  📍 בני ברק (121) - ✅ | 📍 תל אביב (132) - ✅     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 🔧 פונקציונליות מפורטת

### 1. ניהול סורק (Scanner Control)

**Backend API:**
- `GET /api/scanner/status` - מצב נוכחי (פועל/עוצר/טוען)
- `POST /api/scanner/start` - הפעלת סורק
- `POST /api/scanner/stop` - עצירת סורק
- `GET /api/scanner/stats` - סטטיסטיקות (מספר סריקות, התראות וכו')

**Frontend:**
- כפתור הפעלה/עצירה גדול ומרכזי
- אינדיקטור מצב (מנורה/נקודה צבעונית)
- סטטיסטיקות בזמן אמת

---

### 2. ניהול התראות (Alert Management)

**Backend API:**
- `GET /api/alerts/types` - רשימת כל סוגי התראות
- `GET /api/alerts/enabled` - איזה התראות מופעלות
- `POST /api/alerts/enable` - הפעלת התראה מסוימת
- `POST /api/alerts/disable` - כיבוי התראה מסוימת
- `GET /api/alerts/recent` - התראות אחרונות (last 50)
- `GET /api/alerts/history` - היסטוריה מלאה (עם pagination)

**Frontend:**
- רשימת התראות עם Toggle switches
- הצגת קוד TELNET לכל התראה
- אינדיקטור אם התראה מוגדרת (יש לה קוד) או לא

**Settings File (settings.json):**
```json
{
  "alerts": {
    "missiles": { "enabled": true, "code": "00112" },
    "earthQuake": { "enabled": true, "code": "00110" },
    "hostileAircraftIntrusion": { "enabled": true, "code": "00111" },
    "newsFlash": { "enabled": true, "code": "00113" },
    "tsunami": { "enabled": false, "code": null },
    ...
  },
  "scanner": {
    "interval": 3000,
    "autoStart": false
  }
}
```

---

### 3. עדכונים בזמן אמת (Real-time Updates)

**WebSocket Events:**
- `scanner:status` - עדכון מצב סורק
- `alert:new` - התראה חדשה התגלתה
- `alert:sent` - התראה נשלחה לתחנות
- `alert:error` - שגיאה בשליחת התראה
- `stats:update` - עדכון סטטיסטיקות

**Frontend:**
- רשימת התראות מתעדכנת אוטומטית
- התראות חדשות מופיעות עם אנימציה
- עדכון סטטיסטיקות בזמן אמת

---

### 4. ניהול תחנות (Stations Management)

**Backend API:**
- `GET /api/stations` - רשימת כל התחנות
- `GET /api/stations/:city` - תחנות לפי עיר
- `GET /api/stations/affected/:alertId` - תחנות שהושפעו מהתראה מסוימת

**Frontend:**
- טבלת תחנות (עם חיפוש וסינון)
- הצגת תחנות מושפעות בזמן התראה
- מפה ויזואלית (אופציונלי)

---

### 5. היסטוריה ולוגים (History & Logs)

**Backend API:**
- `GET /api/logs` - לוגים אחרונים
- `GET /api/excel` - רשימת קבצי Excel שנוצרו
- `GET /api/excel/:filename` - הורדת קובץ Excel

**Frontend:**
- טבלת היסטוריה עם סינון לפי:
  - סוג התראה
  - תאריך/שעה
  - סטטוס (נשלח/נכשל)
- הורדת קבצי Excel

---

## 🎨 עיצוב (Design Guidelines)

### צבעים מוצעים:
- **ראשי**: כחול (#2563eb) / אדום (#dc2626) לנושא התראות
- **רקע**: לבן/אפור בהיר (#f9fafb)
- **כותרות**: אפור כהה (#1f2937)
- **הצלחה**: ירוק (#10b981)
- **שגיאה**: אדום (#ef4444)
- **אזהרה**: צהוב (#f59e0b)

### טיפוגרפיה:
- **כותרות**: גדולות ובולטות (24px+)
- **טקסט רגיל**: 16px, ריווח נוח
- **תמיכה בעברית**: RTL support

### קומפוננטות:
- **Cards** - לכל חלק בעיצוב
- **Buttons** - גדולים, ברורים, עם אייקונים
- **Badges** - לסטטוסים (✅/❌/⏳)
- **Modals** - להגדרות/פרטים
- **Toast Notifications** - להתראות זמניות

---

## 📅 שלבי פיתוח

### שלב 1: תשתית Backend (2-3 ימים)
- [ ] יצירת Express server
- [ ] הגדרת WebSocket (Socket.io)
- [ ] יצירת API endpoints בסיסיים
- [ ] ניהול Settings (JSON file)
- [ ] אינטגרציה עם Scanner הקיים

### שלב 2: Frontend בסיסי (2-3 ימים)
- [ ] HTML structure
- [ ] CSS styling (עיצוב נקי ומודרני)
- [ ] JavaScript - חיבור ל-API
- [ ] ניהול מצב (state management)

### שלב 3: פונקציונליות Core (3-4 ימים)
- [ ] שליטה בסורק (הפעלה/עצירה)
- [ ] ניהול התראות (enable/disable)
- [ ] הצגת התראות בזמן אמת
- [ ] סטטיסטיקות

### שלב 4: פיצ'רים מתקדמים (2-3 ימים)
- [ ] היסטוריה ולוגים
- [ ] ניהול תחנות
- [ ] הורדת קבצי Excel
- [ ] הגדרות מתקדמות

### שלב 5: פוליש ועיצוב (1-2 ימים)
- [ ] שיפורי UI/UX
- [ ] אנימציות
- [ ] תמיכה בנייד (responsive)
- [ ] בדיקות

**סה"כ: ~10-15 ימי עבודה**

---

## 🔐 אבטחה (אופציונלי)

- **Authentication** - התחברות עם משתמש/סיסמה
- **HTTPS** - עבור שרתים פרודקשן
- **Rate Limiting** - למניעת spam
- **Input Validation** - ולידציה של קלט

---

## 📦 תלויות חדשות (Dependencies)

```json
{
  "dependencies": {
    "express": "^4.18.0",
    "socket.io": "^4.5.0",
    "cors": "^2.8.5",
    "body-parser": "^1.20.0"
  }
}
```

---

## 🚀 הרצה

```bash
# Backend
npm start              # מריץ את השרת + סורק

# או נפרד:
node backend/server.js # רק השרת
node scanner.js        # רק הסורק (CLI)
```

**Web Interface**: `http://localhost:3000`

---

## ✨ Features עתידיים (אופציונלי)

- [ ] מפה אינטראקטיבית עם תחנות
- [ ] התראות Push (דסקטופ/נייד)
- [ ] Export ל-PDF
- [ ] Analytics ו-Dashboards
- [ ] Multi-user support
- [ ] Dark mode

---

**תאריך יצירה**: 2025-12-22  
**גרסה**: 1.0
